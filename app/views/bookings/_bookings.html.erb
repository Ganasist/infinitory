<table class="table table-striped">
  <thead>
    <tr>
      <% if params[:device_id] %>
        <th>User</th>
      <% end %>
      <th>Booked on</th>
      <% unless params[:device_id] %>
        <th>Device</th>
      <% end %>
      <th>Start</th>
      <th>End</th>
      <th>Duration</th>
      <th class="text-right" colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @bookings.each do |booking| %>

      <tr class="<%= if booking.finished? then 'text-danger' end %>">

        <% if params[:device_id] %>
          <td><%= booking.user.fullname %></td>
        <% end %>

        <td><%= booking.updated_at.to_formatted_s(:short) %></td>

        <% if params[:user_id] && booking.device %> 
          <td>
            <%= link_to booking.device.fullname, booking.device %>
          </td>
        <% elsif params[:device_id] && booking.device %>

        <% else %> 
          <td>
            REMOVED
          </td>
        <% end %>

        <td>
          <%= booking.start_time.to_formatted_s(:short) %>
        </td>

        <td><%= booking.end_time.to_formatted_s(:short) %></td>

        <td><%= booking.duration_calculation %></td>

        <% if booking.device && booking.device.bookable %>
          <% unless params[:device_id] %>
            <td><%= link_to 'Schedule', device_bookings_path(booking.device_id) %></td>
          <% end %>

          <% if !booking.expired_one_day? %>
            <td><%= link_to 'Edit', edit_booking_path(booking) %></td>
            <td><%= link_to 'Remove', booking, method: :delete %></td>
          <% else %>
            <td></td>
            <td></td>
          <% end %>
        <% else %>
          <td></td>
          <td></td>
          <td></td>
        <% end %>

      </tr>
    <% end %>
  </tbody>
</table>